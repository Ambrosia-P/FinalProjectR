---
title: "The 2022 European energy crisis"
format: 
  html: default
  pdf: default
editor: visual
autors: "Lou-Ann and Ambrosia"
---

All the files and previous phases of the project can be find in the following repository (in the final branch) : https://github.com/Ambrosia-P/FinalProjectR.git

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)

```

# Introduction

The European energy crisis of 2022 represents one of the most significant economic shocks to affect the continent in recent decades. Following Russia's invasion of Ukraine in February 2022, natural gas prices surged to unprecedented levels as European countries faced severe disruptions to their primary energy supply. The Dutch TTF Natural Gas Futures, Europe's benchmark for gas prices, reached historic peaks during the summer and fall of 2022, multiplying several times over compared to pre-crisis levels. This energy shock had immediate and profound consequences for electricity markets across Europe. Given the central role of natural gas in electricity generation and its position as the marginal fuel in many European markets, the surge in gas prices translated rapidly into higher electricity costs for consumers and businesses. However, the impact was far from uniform. Different countries experienced vastly different price trajectories, reflecting variations in their energy systems, market structures, and exposure to gas imports.

This analysis examines the heterogeneous responses of nine European countries to the 2022 energy crisis: Bulgaria, Denmark, Finland, France, Germany, Netherlands, Poland, Spain, and Sweden. Our central research question is: **What explains the cross-country variation in vulnerability and response to the 2022 energy shock?**

We investigate this question through several complementary approaches. First, we document the nature and magnitude of the initial shock by analyzing the evolution of gas and electricity prices during the crisis period, examining both the timing and amplitude of price increases. Second, we examine national energy mix structures before and after the shock to understand how countries' pre-existing energy systems shaped their exposure, and whether significant structural adjustments occurred in response to the crisis. Third, we measure shock persistence through ARMA modeling to assess how long electricity price disturbances lasted in each country and identify cross-country variation in adjustment speeds. Fourth, we construct a composite vulnerability index combining gas dependence, import volumes, and price responses to assess which countries were most exposed to the crisis. Finally, we analyze the factors explaining cross-country heterogeneity through correlation analysis and panel regression, testing whether gas dependence systematically amplified the crisis impact while controlling for country-specific characteristics. This multifaceted approach allows us to examine both the immediate shock transmission and longer-term adjustment dynamics across European energy systems.

```{r}
library(ggplot2)
library(readr)
library(vroom)
library(dplyr)
library(tidyr)
library(tidyverse)
library(ggplot2)
library(knitr)
library(rnaturalearth)
library(rnaturalearthdata)
library(forecast)
```

```{r}
energy_prices <- read.csv2("cleaned_data/Energypricescleaned.csv")
energy_prices <- energy_prices[-11,] 
colnames(energy_prices)[-1] <- sub("^X", "", colnames(energy_prices)[-1])

gas_prices <- read.csv2("cleaned_data/Gaspricescleaned.csv")

importation <- read.csv("cleaned_data/Total_import.csv")
importation_list <- split(importation, importation$Country)

sources <- read.csv("cleaned_data/all_sources.csv")
sources_list <- split(sources, sources$Country)
```

# Data description

Our analysis relies on four main data sets covering the period from 2019 to 2024. 

**Electricity prices** are sourced from Eurostat on a semi-annual basis (S1, S2) for nine European countries: Bulgaria, Denmark, Finland, France, Germany, Netherlands, Poland, Spain, and Sweden. Prices are expressed in EUR per MWh and reflect household consumer costs.

**Natural gas prices** come from the Dutch TTF Natural Gas Futures historical data, providing monthly observations of Europe benchmark gas price. 

**Energy production by source** is obtained from Eurostat's energy statistics, disaggregated into combustible fuels, natural gas, nuclear, hydro, solar, wind, and total renewable production, allowing us to construct detailed energy mix profiles for each country on a monthly basis. 

**Gas import data**, including both pipeline imports and LNG imports measured in Million Cubic Meters (MCM), are sourced from Eurostat, enabling us to quantify each country's Russian gas dependence.

All data sets required extensive cleaning and harmonization to ensure consistency across sources and time periods. Monthly data were aggregated to semi-annual or annual frequencies where appropriate to match electricity price periodicity and reduce noise in structural indicators. Detailed data cleaning procedures, variable definitions, and preliminary descriptive statistics are documented in our Phase 2 submission.

# The 2022 energy shock

The 2022 energy crisis originated in the natural gas market and rapidly transmitted to electricity prices across Europe. In this section, we document the nature and magnitude of this shock by analyzing the evolution of gas and electricity prices during the crisis period. Understanding the timing, amplitude, and transmission mechanism of the shock is essential to interpreting the heterogeneous responses observed across countries in subsequent sections.

```{r}
gas_evolution <- gas_prices |> pivot_longer(cols = c(S1, S2), names_to = "semester", values_to = "price") |> mutate(price = as.numeric(gsub(",", ".", price)), period = paste0(year, "-", semester)) |> arrange(year, semester)

ggplot(gas_evolution, aes(x = period, y = price, group = 1)) +
  geom_line(color = "blue", size = 1.2) +
  geom_point(color = "blue", size = 2.5) +
  geom_vline(xintercept = 7, linetype = "dashed", color = "red", size = 1) +
  annotate("text", x = 6, y = max(gas_evolution$price, na.rm = TRUE) * 0.85, 
           label = "Crisis onset\n(2022-S1)", color = "red", size = 4) +
  labs(title = "Evolution of Dutch TTF Natural Gas Prices (2019-2024)",
       x = "Period (Year-Semester)",
       y = "Price (EUR/MWh)") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 10),
        plot.title = element_text(size = 14, face = "bold"))
```

The graph clearly illustrates the dramatic gas price shock that began in 2022. Natural gas prices remained stable around EUR 15-20 per MWh from 2019 through 2021. Starting in early 2022, prices surged sharply, reaching a peak of approximately EUR 160 per MWh in the second semester of 2022, representing an eightfold increase from pre-crisis levels. This unprecedented spike coincided with Russia's invasion of Ukraine and the disruption of Russian gas supplies to Europe. Following the peak, prices declined but stabilized at elevated levels around EUR 35-45 per MWh in 2023-2024, substantially above pre-crisis norms, suggesting persistent structural changes in European gas markets.

```{r}

avg_elec_prices <- energy_prices |> 
  select(-Country) |> 
  summarise(across(everything(), ~mean(.x, na.rm = TRUE))) |> 
  pivot_longer(cols = everything(), names_to = "period", values_to = "avg_price")

ggplot(avg_elec_prices, aes(x = period, y = avg_price, group = 1)) +
  geom_line(color = "darkgreen", size = 1.2) +
  geom_point(color = "darkgreen", size = 2.5) +
  geom_vline(xintercept = 5, linetype = "dashed", color = "red", size = 1) +
  annotate("text", x = 5, y = max(avg_elec_prices$avg_price, na.rm = TRUE) * 0.85,
           label = "Crisis onset", color = "red", size = 4) +
  labs(title = "Average Electricity Prices Across Nine European Countries (2019-2024)",
       x = "Period (Year-Semester)",
       y = "Price (EUR/MWh)") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 10),
        plot.title = element_text(size = 14, face = "bold"))
```

The graph illustrates the rapid transmission of the gas price shock to electricity markets. Average electricity prices across the nine countries remained stable around EUR 115 per MWh from 2019 through early 2021. Starting in the second semester of 2021, prices began to rise, accelerating sharply throughout 2022. Prices peaked in the second semester of 2022 at approximately EUR 225 per MWh, representing a 95% increase from pre-crisis levels. This timing closely mirrors the gas price surge, confirming the strong linkage between gas and electricity markets through the merit order mechanism. Following the peak, prices declined moderately in 2023-2024 but stabilized around EUR 185-190 per MWh, approximately 60% above pre-crisis levels. This persistent elevation suggests lasting structural changes in European energy markets rather than a temporary disruption.

```{r}

gas_pre <- gas_prices |> 
  filter(year %in% c(2019, 2020, 2021)) |> 
  summarise(avg = mean(c(as.numeric(S1), as.numeric(S2)), na.rm = TRUE))

gas_peak <- gas_prices |> 
  filter(year == 2022) |> 
  summarise(peak = max(c(as.numeric(S1), as.numeric(S2)), na.rm = TRUE))

elec_pre <- avg_elec_prices |> 
  filter(grepl("2019|2020|2021", period)) |> 
  summarise(avg = mean(avg_price, na.rm = TRUE))

elec_peak <- avg_elec_prices |> 
  filter(grepl("2022", period)) |> 
  summarise(peak = max(avg_price, na.rm = TRUE))


shock_summary <- data.frame(
  Indicator = c("Gas Price (EUR/MWh)", "Electricity Price (EUR/MWh)"),
  `Pre-crisis Average` = c(round(gas_pre$avg, 1), round(elec_pre$avg, 1)),
  `Peak 2022` = c(round(gas_peak$peak, 1), round(elec_peak$peak, 1)),
  `Increase` = c(
    paste0("+", round((gas_peak$peak / gas_pre$avg - 1) * 100, 0), "%"),
    paste0("+", round((elec_peak$peak / elec_pre$avg - 1) * 100, 0), "%")
  ),
  check.names = FALSE)

kable(shock_summary, caption = "Summary of the 2022 Energy Shock (2019-2021 vs 2022 Peak)")
```

The summary table quantifies the magnitude of the 2022 energy shock across both gas and electricity markets. Natural gas prices increased dramatically from an average of EUR 23.5 per MWh during 2019-2021 to a peak of EUR 160.9 per MWh in 2022, representing an extraordinary 584% increase. This unprecedented surge in gas prices transmitted to electricity markets, where average prices rose from EUR 121.1 per MWh pre-crisis to EUR 224.1 per MWh at the 2022 peak, an 85% increase. The differential in percentage increases between gas and electricity prices reflects several factors. First, electricity generation relies on multiple fuel sources beyond gas, providing some buffering effect. Second, regulatory interventions in some countries capped consumer electricity prices, dampening the observed price response. Third, the merit order mechanism means electricity prices respond to marginal costs rather than average generation costs. Nevertheless, the substantial electricity price increase confirms that the gas shock successfully propagated throughout European energy systems, creating significant economic pressure on households and businesses across the continent.

# National Energy mix structures

In this section, we will focus on the national energy mix structures before and after the gas price shock. Indeed, we will study the structural difference across countries and how these structures changes over time as a response to the shock. Two type of comparison will provide insight into the dynamics triggered by the 2022 crisis :

-   A comparison pre/post shock within a same country will highlight the potential adjustment in its energy system triggered by the crisis.
-   A cross country comparison allows us to show that the countries enter the 2022 crisis with different profiles and exposure levels

This part is fundamental to the structure of our analysis since it will justify the persistence of the shocks and the heterogeneity of the responses provided.

### Energy mix computation


```{r}
compute_mix <- function(df) {df |> mutate(combustible = Combustible.fuels - Natural.gas,`combustible share` = round((combustible / Total) * 100, 2),`nuclear share` = round((Nuclear.fuels.and.other.fuels.n.e.c. / Total) * 100, 2),`gas share` = round((Natural.gas / Total) * 100, 2),`renewable share` = round((Renewables.and.biofuels / Total) * 100, 2)) |>select(-c(3:11))}

mix_list <- lapply(sources_list, compute_mix)
mix_france <- mix_list$France
mix_bulg <- mix_list$Bulgaria
mix_den <- mix_list$Denmark
mix_fin <- mix_list$Finland
mix_germ <- mix_list$Germany
mix_neth <- mix_list$Netherlands
mix_pol <- mix_list$Poland
mix_spa <- mix_list$Spain
mix_swe <- mix_list$Sweden
```

Since the energy mix shares are slow moving indicators, we aggregate the monthly variables at the annual level.

```{r}
mix_year <- function(df) {df |> mutate(year = as.integer(substr(Year, 1, 4))) |> group_by(year) |> summarise(`combustible share` = round(mean(`combustible share`, na.rm = TRUE), 2),`nuclear share`     = round(mean(`nuclear share`, na.rm = TRUE),2), `gas share`= round(mean(`gas share`, na.rm = TRUE), 2),`renewable share`   = round(mean(`renewable share`, na.rm = TRUE), 2),.groups = "drop") |> filter(year != 2025)}

mix_france <- mix_year(mix_france)
mix_bulg   <- mix_year(mix_bulg)
mix_den    <- mix_year(mix_den)
mix_fin    <- mix_year(mix_fin)
mix_germ   <- mix_year(mix_germ)
mix_neth   <- mix_year(mix_neth)
mix_pol    <- mix_year(mix_pol)
mix_spa    <- mix_year(mix_spa)
mix_swe    <- mix_year(mix_swe)

kable(mix_france, caption = "France's Energy Mix per year (percent)")
kable(mix_bulg, caption = "Bulgaria's Energy Mix per year (percent)")
kable(mix_den, caption = "Denmark's Energy Mix per year (percent)")
kable(mix_fin, caption = "Finland's Energy Mix per year (percent)")
kable(mix_germ, caption = "Germany's Energy Mix per year (percent)")
kable(mix_neth, caption = "Netherlands' Energy Mix per year (percent)")
kable(mix_pol, caption = "Poland's Energy Mix per year (percent)")
kable(mix_spa, caption = "Spain's Energy Mix per year (percent)")
kable(mix_swe, caption = "Sweden's Energy Mix per year (percent)")
```

### Exposure profiles pre and post crisis

Our analysis focuses on a comparison between pre-crisis and post-crisis structures. Therefore, we divide our data sets into two time periods :

-   2019 - 2021 for the pre-crisis period
-   2022 - 2024 for the post-crisis period

As structural variables, we use the mean of each annual share over these periods

```{r}

struct <- function(df){df|> mutate(period = case_when(year>= 2019 & year<= 2021~"Pre-crisis", year>=2022 & year<=2024~"Post-crisis")) |> group_by(period) |>  summarize(`combustible share`=round(mean(`combustible share`),2), `nuclear share`=round(mean(`nuclear share`),2), `gas share`=round(mean(`gas share`),2), `renewable share`= round(mean(`renewable share`),2))}

struct_france <- struct(mix_france)
struct_bulg <- struct(mix_bulg)
struct_den <- struct(mix_den)
struct_fin <- struct(mix_fin)
struct_germ <- struct(mix_germ)
struct_pol <- struct(mix_pol)
struct_neth <- struct(mix_neth)
struct_spa <- struct(mix_spa)
struct_swe <- struct(mix_swe)

kable(struct_france, caption = "France's energy mix structure pre and post the 2022 energy crisis")
kable(struct_bulg, caption = "Bulgaria's energy mix structure pre and post the 2022 energy crisis")
kable(struct_den, caption = "Denmark's energy mix structure pre and post the 2022 energy crisis")
kable(struct_fin, caption = "Finland's energy mix structure pre and post the 2022 energy crisis")
kable(struct_germ, caption = "Germany's energy mix structure pre and post the 2022 energy crisis")
kable(struct_neth, caption = "Netherlands' energy mix structure pre and post the 2022 energy crisis")
kable(struct_pol, caption = "Poland's energy mix structure pre and post the 2022 energy crisis")
kable(struct_spa, caption = "Spain's energy mix structure pre and post the 2022 energy crisis")
kable(struct_swe, caption = "Sweden's energy mix structure pre and post the 2022 energy crisis")
```

### Period comparison and structural adjustments


```{r}
struct_long <- function(df) {df |> mutate(period = factor(period, levels = c("Pre-crisis", "Post-crisis"))) |> pivot_longer(cols = -period,names_to = "Energy sources",values_to = "Share")}


struct_france_long <- struct_long(struct_france)
struct_bulg_long <- struct_long(struct_bulg)
struct_den_long <- struct_long(struct_den)
struct_fin_long <- struct_long(struct_fin)
struct_germ_long <- struct_long(struct_germ)
struct_neth_long <- struct_long(struct_neth)
struct_pol_long <- struct_long(struct_pol)
struct_spa_long <- struct_long(struct_spa)
struct_swe_long <- struct_long(struct_swe)

all_struct_long <- bind_rows(struct_france_long |> mutate(country = "France"), struct_bulg_long|> mutate(country = "Bulgaria"), struct_den_long|> mutate(country = "Denmark"), struct_fin_long |> mutate(country = "Finland"), struct_germ_long|> mutate(country = "Germany"), struct_neth_long |> mutate(country = "Netherlands"), struct_pol_long|> mutate(country = "Poland"), struct_spa_long|> mutate(country = "Spain"), struct_swe_long|> mutate(country = "Sweden"))
```

```{r}
ggplot(all_struct_long, aes(x = `Energy sources`, y = Share, fill = period)) +
  geom_bar(stat = "identity", position = "dodge") +
  facet_wrap(~ country) +
  labs(title = "Electricity generation structure before and after the 2022 crisis")

```

```{r}
delta_france <- struct_france$`gas share`[2] - struct_france$`gas share`[1]
delta_bulg <- struct_bulg$`gas share`[2] - struct_bulg$`gas share`[1]
delta_den <- struct_den$`gas share`[2] - struct_den$`gas share`[1]
delta_fin <- struct_fin$`gas share`[2] - struct_fin$`gas share`[1]
delta_germ <- struct_germ$`gas share`[2] - struct_germ$`gas share`[1]
delta_neth <- struct_neth$`gas share`[2] - struct_neth$`gas share`[1]
delta_pol <- struct_pol$`gas share`[2] - struct_pol$`gas share`[1]
delta_spa <- struct_spa$`gas share`[2] - struct_spa$`gas share`[1]
delta_swe <- struct_swe$`gas share`[2] - struct_swe$`gas share`[1]

deltas <- c(delta_france, delta_bulg, delta_swe, delta_spa, delta_pol, delta_neth, delta_germ, delta_fin, delta_den)
mean_delta <- round(mean(deltas),2)
```

Our descriptive analysis of the national energy mix structure does not bring out major structural transformations in the electricity production systems as one might expect following such a severe shock. Instead, we observe only marginal changes or slight adjustments, most often an increase in the share of renewable sources, while the global structure remains generally unchanged. In particular what is striking is that countries do not undertake major cut in their use of gas despite the intensity of the shock. On average, the decrease in the gas share after the crisis is of `r round(mean_delta,2)` percentage points, which does not illustrate a shift away from gas in the energy mix. This stability highlights the rigidity of the national energy mix structures in the short run. This is due to technological constraints : infrastructures cannot be transformed overnight, and path dependency may delay adjustments. The study of the energy mixes therefore suggests that the crisis was not absorbed through technology adjustments, but through prices. Consequently, we will focus on this intuition in the next parts of our analysis.

### Structural heterogeneity and typology of energy systems

We now shift our focus from time comparison to cross-country comparison. This part of the analysis is centered around the pre-crisis energy mix since we want to study how the countries entered the crisis, and not how they react yet. We recall the pre-crisis energy mix structures :

```{r}
mix_pre <- bind_rows(struct_france |> filter(period=="Pre-crisis") |> mutate(country= "France"), struct_bulg |> filter(period=="Pre-crisis") |> mutate(country= "Bulgaria"),struct_fin |> filter(period=="Pre-crisis") |> mutate(country= "Finland"),struct_den |> filter(period=="Pre-crisis") |> mutate(country= "Denmark"), struct_germ |> filter(period=="Pre-crisis") |> mutate(country= "Germany"),struct_neth |> filter(period=="Pre-crisis") |> mutate(country= "Netherlands"),struct_pol |> filter(period=="Pre-crisis") |> mutate(country= "Poland"), struct_spa |> filter(period=="Pre-crisis") |> mutate(country= "Spain"),struct_swe |> filter(period=="Pre-crisis") |> mutate(country= "Sweden")) |> select(-c("period")) |> relocate(country, .before=1 )

kable(mix_pre, caption = "Energy mix structure pre-crisis per country")
```

```{r}
mix_pre_long <- mix_pre |> pivot_longer(cols = -country, names_to = "sources", values_to = "share")

ggplot(mix_pre_long, aes(x= share, y = country, color= country))+
  geom_point(size = 2)+
  facet_wrap(~sources)+
  labs(title = "Pre-crisis electricity generation mix across countries")
```

This graphical representation cast light on the heterogeneity of the national electricity generation structure before the crisis. As we can observe, the points, representing one country's share of a specific sources, are scattered across the graph, which illustrates major differences between countries in their electricity generation system. However, this representation treats sources in isolation. To construct a relevant typology, we complete this source-by-source comparison with a study of the different technologies' interaction within each national systems. For that, we need to look at the gas share in relation to the other alternative available in a country. We will only consider nuclear fuels and renewable sources as alternative to gas, since combustible fuels are also fossil fuels.

```{r}
ggplot(mix_pre, aes(x = `gas share`, y = `nuclear share` + `renewable share`)) +
  geom_point(size = 2) +
  geom_text(aes(label = country), vjust = -0.5) +
  labs(x = "Gas share (%)", y = "Non-gas electricity sources (%)", title = "Structural exposure to gas in pre-crisis electricity systems")

```

This figure displays the pre-crisis share of gas used in electricity generation against the availability of non-gas alternatives. In the upper-left corner, we observe countries that rely primarily on other alternative sources and therefore exhibit low exposure to gas. In contrast, the lower-right corner includes countries that use a large share of gas relative to non-gas sources, and are thus more exposed to a gas supply shock. The countries located the central part of the graph occupy an intermediate position : while they have alternatives available, they still use a substantial amount of gas, which implies they remain exposed to gas market dynamics.

Following these graphical representations, we want to suggest a classification of the countries according to their pre-crisis energy mix structure. This typology splits the countries in 4 groups : 

- nuclear-based systems 
- renewable-heavy systems 
- gas- exposed systems
- fossil-fuels-intensive systems

We would like to mention that these categories are not exclusive, neither describe which source is dominant in a national energy mix. These groups rather aim at highlighting the heterogeneity of the pre-crisis structure and therefore of the exposure to the 2022 shock.

| Category               | Countries                |
|------------------------|--------------------------|
| Nuclear-based          | France, Bulgaria\*       |
| Gas-exposed            | Netherlands, Spain       |
| Fossil-fuels-intensive | Poland, Germany\*        |
| Renewable heavy        | Sweden, Denmark, Finland |

: Energy mix structure classification 

\* Bulgaria could also belongs to the fossil-fuels-intensive systems. 
Germany could also belongs to the renewable-heavy category. s

The most important result of this descriptive analysis is that the countries enter the crisis with very different dispositions. The intuition underlying this idea is that gas exposed systems would be more affected by the shock that systems that rely mainly on alternatives fuels such as nuclear or renewables. Therefore, a study of the pre-crisis structure's diversity suggests that country will respond differently through the crisis. This intuition will be examined in the last part of the report.

The descriptive analysis of national energy mix structures is fundamental to understand the context in which the crisis took place and the nature of the shock. Indeed, countries did not enter the shock under the same conditions, as they display highly heterogeneous electricity generation structures. The proposed typology supports our main hypothesis : the responses to the 2022 energy crisis differed markedly across European countries. However, one of the main result of this section's analysis is that the national energy mixes exhibit very limited short-run adjustments. Indeed, despite the intensity of the 2022 shock, the structures have remained largely stable. These empirical findings imply that the adjustment to the crisis was unlikely to occur through technology changes, motivating a closer examination of price dynamics and shock persistence in the following sections.

# Electricity price dynamics and shock persistence

The previous sections have established two main results : the 2022 gas price shock generated large electricity price movements but the short-run adjustments remained limited. Facing the limited scope of technological transformations, our focus now shifts to a further analysis of price dynamics, since the larger share of adjustments have likely occurred through prices.

In this case, persistence is central because it governs how the shock continues to affect one country's economy. If all European countries have experienced the same price shock, persistence heterogeneity suggests different implications in term of welfare. 

## ARMA estimation

To examine the persistence of the shock we examine the national electricity prices from 2019 to 2024, the data being semiannual. We use an ARMA model (equivalent to an ARIMA model with d=0) to study the trends and estimate the coefficient. Here, we center our focus on the AR coefficient, since they govern the memory of a process and therefore capture the durability of a price shock.The form of the resulting series will be such that : $P_{t} = \mu + \sum_{i=1}^{p} \phi_{i} P_{t-i} + \sum_{i = 0}^{q} \theta_{i}\epsilon_{t-i}$.

To estimate our model coefficient, we use the auto.arima function that gives the preferred specification for each country by automatically minimize the Akaike Information Criterion (AIC).

Remarks : 

- Models adequacy is assessed using Ljung-Box tests on residuals for autocorrelation and basic stability and if needed invertibility checks. For all countries, these tests showed that the estimated AR coefficients satisfy stationarity conditions and autocorrelation is not significant.

- Given the limited number of observations, the ARMA analysis is used as an explanatory tool rather than for forecasting purposes.

### France

```{r}
elec_prices_long <- energy_prices |> slice(-1)|> pivot_longer(cols=-Country, names_to = "date", values_to = "price") |> mutate(log_price=log(price))
```

```{r}

y <- elec_prices_long |> filter(Country == "France") |> arrange(date) |> pull(log_price)

fit_france <- auto.arima(y,d = 0, max.d = 0, max.p = 1, max.q = 1, seasonal = FALSE, stationary = TRUE, stepwise = FALSE, approximation = FALSE)

```

```{r, results='hide'}
summary(fit_france)
```

$P_{t} = 5.0452+  0.9466P_{t-1} + \epsilon_{t}+ 0.6525\epsilon_{t-1}$

```{r, results='hide'}
phi <- coef(fit_france)["ar1"]
abs(phi) < 1

```

```{r, results='hide'}
theta <- coef(fit_france)["ma1"]
abs(theta) < 1

```

```{r, results='hide'}
Box.test(residuals(fit_france), lag = 4, type = "Ljung-Box")

```

### Bulgaria

```{r}

y <- elec_prices_long |> filter(Country == "Bulgaria") |> arrange(date) |> pull(log_price)

fit_bulg <- auto.arima(y,d = 0, max.d = 0, max.p = 1, max.q = 1, seasonal = FALSE, stationary = TRUE, stepwise = FALSE, approximation = FALSE)

```

```{r, results='hide'}
summary(fit_bulg)
```

$P_{t} = 4.5132+  0.9191P_{t-1} + \epsilon_{t}$

```{r, results='hide'}
phi <- coef(fit_bulg)["ar1"]
abs(phi) < 1

```

```{r, results='hide'}
Box.test(residuals(fit_bulg), lag = 4, type = "Ljung-Box")

```

### Denmark

```{r}

y <- elec_prices_long |> filter(Country == "Denmark") |> arrange(date) |> pull(log_price)

fit_den <- auto.arima(y,d = 0, max.d = 0, max.p = 1, max.q = 1, seasonal = FALSE, stationary = TRUE, stepwise = FALSE, approximation = FALSE)

```

```{r, results='hide'}
summary(fit_den)
```

$P_{t} = 5.0320+  0.9191P_{t-1} + \epsilon_{t}$

```{r, results='hide'}
phi <- coef(fit_den)["ar1"]
abs(phi) < 1

```

```{r, results='hide'}
Box.test(residuals(fit_den), lag = 4, type = "Ljung-Box")

```

### Finland

```{r}

y <- elec_prices_long |> filter(Country == "Finland") |> arrange(date) |> pull(log_price)

fit_fin <- auto.arima(y,d = 0, max.d = 0, max.p = 1, max.q = 1, seasonal = FALSE, stationary = TRUE, stepwise = FALSE, approximation = FALSE)

```

```{r, results='hide'}
summary(fit_fin)
```

$P_{t} = 4.9457+  0.8296 P_{t-1} + \epsilon_{t}$

```{r, results='hide'}
phi <- coef(fit_fin)["ar1"]
abs(phi) < 1

```

```{r, results='hide'}
Box.test(residuals(fit_fin), lag = 4, type = "Ljung-Box")

```

### Germany

```{r}

y <- elec_prices_long |> filter(Country == "Germany") |> arrange(date) |> pull(log_price)

fit_germ <- auto.arima(y,d = 0, max.d = 0, max.p = 1, max.q = 1, seasonal = FALSE, stationary = TRUE, stepwise = FALSE, approximation = FALSE)

```

```{r, results='hide'}
summary(fit_germ)
```

$P_{t} = 5.3001+  0.9276 P_{t-1} + \epsilon_{t}$

```{r, results='hide'}
phi <- coef(fit_germ)["ar1"]
abs(phi) < 1

```

```{r, results='hide'}
Box.test(residuals(fit_germ), lag = 4, type = "Ljung-Box")

```

### Netherlands

```{r}

y <- elec_prices_long |> filter(Country == "Netherlands") |> arrange(date) |> pull(log_price)

fit_neth <- auto.arima(y,d = 0, max.d = 0, max.p = 1, max.q = 1, seasonal = FALSE, stationary = TRUE, stepwise = FALSE, approximation = FALSE)

```

```{r, results='hide'}
summary(fit_neth)
```

$P_{t} = 5.2693+  0.7972 P_{t-1} + \epsilon_{t}$

```{r, results='hide'}
phi <- coef(fit_neth)["ar1"]
abs(phi) < 1

```

```{r, results='hide'}
Box.test(residuals(fit_neth), lag = 4, type = "Ljung-Box")

```

### Poland

```{r}

y <- elec_prices_long |> filter(Country == "Poland") |> arrange(date) |> pull(log_price)

fit_pol <- auto.arima(y,d = 0, max.d = 0, max.p = 1, max.q = 1, seasonal = FALSE, stationary = TRUE, stepwise = FALSE, approximation = FALSE)

```

```{r, results='hide'}
summary(fit_pol)
```

$P_{t} = 4.5855 + \epsilon_{t}$

As we can see, the preferred specification through AIC reduces the model to only a constant. To ensure comparability between countries, we impose an AR(1) specification by setting p = 1.

```{r, results='hide'}
fit_pol_AR <- Arima(y, order = c(1,0,0), include.mean = TRUE)
summary(fit_pol_AR)

```

$P_{t} = 5.0128+  0.5768 P_{t-1} + \epsilon_{t}$

```{r, results='hide'}
phi <- coef(fit_pol_AR)["ar1"]
abs(phi) < 1

```

```{r, results='hide'}
Box.test(residuals(fit_pol_AR), lag = 4, type = "Ljung-Box")

```

### Spain

```{r}

y <- elec_prices_long |> filter(Country == "Spain") |> arrange(date) |> pull(log_price)

fit_spa <- auto.arima(y,d = 0, max.d = 0, max.p = 1, max.q = 1, seasonal = FALSE, stationary = TRUE, stepwise = FALSE, approximation = FALSE)

```

```{r, results='hide'}
summary(fit_spa)
```

$P_{t} = 5.1219+  0.7876 P_{t-1} + \epsilon_{t}$

```{r, results='hide'}
phi <- coef(fit_spa)["ar1"]
abs(phi) < 1

```

```{r, results='hide'}
Box.test(residuals(fit_spa), lag = 4, type = "Ljung-Box")

```

### Sweden

```{r}

y <- elec_prices_long |> filter(Country == "Sweden") |> arrange(date) |> pull(log_price)

fit_swe <- auto.arima(y,d = 0, max.d = 0, max.p = 1, max.q = 1, seasonal = FALSE, stationary = TRUE, stepwise = FALSE, approximation = FALSE)

```

```{r, results='hide'}
summary(fit_swe)
```

$P_{t} = 5.0128+  0.5768 P_{t-1} + \epsilon_{t}$

```{r, results='hide'}
phi <- coef(fit_swe)["ar1"]
abs(phi) < 1

```

```{r, results='hide'}
Box.test(residuals(fit_swe), lag = 4, type = "Ljung-Box")

```

## Measure of shock persistence

The AR coefficient of the fitted ARMA model does not directly reflect the duration of a shock. To properly examine the persistence, we build a indicator that is comparable between countries. We define the half life as the number of semesters required for the effect of one unit of price shock to decline by 50% compared to its initial level. The half life of a shock is computed as following : $HL_c = log(0.5)/log(|\hat{\phi_i}|)$

```{r, results='hide'}
HL <- function(fit) {phi <- coef(fit)[["ar1"]]
  log(0.5) / log(abs(phi))
}

HL_fra <- HL(fit_france)
HL_bulg <- HL(fit_bulg)
HL_den <- HL(fit_den)
HL_fin <- HL(fit_fin)
HL_germ <- HL(fit_germ)
HL_neth <- HL(fit_neth)
HL_pol <- HL(fit_pol_AR)
HL_spa <- HL(fit_spa)
HL_swe <- HL(fit_swe)

```

```{r}
phi_fra <- coef(fit_france)[["ar1"]]
phi_bulg <-coef(fit_bulg)[["ar1"]]
phi_den <-coef(fit_den)[["ar1"]]
phi_fin <-coef(fit_fin)[["ar1"]]
phi_germ <-coef(fit_germ)[["ar1"]]
phi_neth <-coef(fit_neth)[["ar1"]]
phi_pol <-coef(fit_pol_AR)[["ar1"]]
phi_spa <-coef(fit_spa)[["ar1"]]
phi_swe <-coef(fit_swe)[["ar1"]]

persistence <- data_frame( country = c("France", "Bulgaria", "Denmark", "Finland", "Germany", "Netherlands", "Poland", "Spain", "Sweden"), AR1 = c(phi_fra, phi_bulg, phi_den, phi_fin, phi_germ, phi_neth, phi_pol, phi_spa, phi_swe), `Half Life`= c(HL_fra, HL_bulg, HL_den, HL_fin, HL_germ, HL_neth, HL_pol, HL_spa, HL_swe))

kable(persistence, caption = "Half life of the shock per country")

```

```{r}
mean_HL <- mean(persistence$`Half Life`)
```

```{r}
ggplot(persistence, aes(x = country, y = `Half Life`)) +
  geom_point(size = 3) +
  geom_hline(yintercept = mean(persistence$`Half Life`), linetype = "dashed")


```

The estimated ARMA models show that the electricity prices come back to their initial level slowly after the 2022 gas price shock, since the auto regressive coefficient are close to unity. As a consequence, the half lives of the shock span multiple years in almost all countries : on average, countries take `r round(mean_HL)` semesters to absorb the shock ie 2,5 years. However we observe a substantial heterogeneity among countries as highlighted by the graphical representation where half life values are largely spread on the graph. While some countiries exhibit rapid adjustments (Poland, Sweden), some other display prolonged price effects (France, Germany, Bulgaria) . Therefore, the observed heterogeneity in electricity price shock persistence raise the question of which structural factors govern the cross-country differences.

# Cross country heterogeneity in responses to the energy crisis

The last sections documented substantial heterogeneity both in the conditions in which the countries entered the crisis and in the way they were affected by the 2022 gas price shock through the persistence of the electricity price disruption. This section now investigate the underlying causal and multidimensional factors of these dynamics.

## Composite Vulnerability Index

In this section, we construct a composite vulnerability index to assess how exposed each country was to the 2022 energy crisis. This index combines three key dimensions of vulnerability:

-   Gas dependence: the share of natural gas in the national electricity production mix in 2021, reflecting structural reliance on gas.
-   Import volume: the total volume of gas imports in 2021, measured in Million Cubic Meters (MCM), capturing the scale of external dependence.
-   Price increase: the percentage change in electricity prices between 2021 and 2022, illustrating the immediate shock intensity.

To ensure comparability across these three indicators, we normalize each variable on a 0-100 scale before averaging them into a single vulnerability score. Countries with higher scores were more exposed to the crisis through a combination of structural dependence, import reliance, and price volatility.

```{r}
gas_dep <- rbind(
  mix_france |> filter(year == 2021) |> mutate(Country = "France"),
  mix_bulg |> filter(year == 2021) |> mutate(Country = "Bulgaria"),
  mix_den |> filter(year == 2021) |> mutate(Country = "Denmark"),
  mix_fin |> filter(year == 2021) |> mutate(Country = "Finland"),
  mix_germ |> filter(year == 2021) |> mutate(Country = "Germany"),
  mix_neth |> filter(year == 2021) |> mutate(Country = "Netherlands"),
  mix_pol |> filter(year == 2021) |> mutate(Country = "Poland"),
  mix_spa |> filter(year == 2021) |> mutate(Country = "Spain"),
  mix_swe |> filter(year == 2021) |> mutate(Country = "Sweden")
) |> select(Country, `gas share`)

```

```{r}

import_dep <- importation |> 
  mutate(year = as.integer(substr(Year, 1, 4))) |> 
  filter(year == 2021) |> 
  group_by(Country) |> 
  summarize(Import_volume = sum(Total_MCM, na.rm = TRUE))
```

```{r}

price_2021 <- energy_prices |> 
  mutate(price_2021 = (`2021.S1` + `2021.S2`) / 2) |> 
  select(Country, price_2021)

price_2022 <- energy_prices |> 
  mutate(price_2022 = (`2022.S1` + `2022.S2`) / 2) |> 
  select(Country, price_2022)

price_change <- price_2021 |> 
  left_join(price_2022, by = "Country") |> 
  mutate(price_increase = round(((price_2022 - price_2021) / price_2021) * 100, 2)) |> 
  select(Country, price_increase)

```

```{r}

vulnerability_data <- gas_dep |> 
  left_join(import_dep, by = "Country") |> 
  left_join(price_change, by = "Country") |> 
  filter(!is.na(price_increase))

```

```{r}

vulnerability_index <- vulnerability_data |> 
  mutate(
    gas_norm = (`gas share` - min(`gas share`)) / (max(`gas share`) - min(`gas share`)) * 100,
    import_norm = (Import_volume - min(Import_volume)) / (max(Import_volume) - min(Import_volume)) * 100,
    price_norm = (price_increase - min(price_increase)) / (max(price_increase) - min(price_increase)) * 100,
    vulnerability_score = round((gas_norm + import_norm + price_norm) / 3, 2)
  ) |> 
  select(Country, `gas share`, Import_volume, price_increase, vulnerability_score) |> 
  arrange(desc(vulnerability_score))

kable(vulnerability_index, caption = "Composite Vulnerability Index by Country")
```

The composite vulnerability index reveals significant heterogeneity across European countries in their exposure to the 2022 energy crisis. The Netherlands emerges as the most vulnerable country with a score of 56.01, driven by its exceptionally high gas dependence (46.44% of electricity production) combined with a substantial price increase of 88.31%. Germany follows closely with a vulnerability score of 50.88, as its massive import volume of nearly 58,000 MCM amplifies its exposure despite a more moderate gas share of 14.70%. At the other end of the spectrum, Poland, Sweden, and France display the lowest vulnerability scores, all below 10. Poland's low score (6.67) is particularly notable given its modest gas share and the smallest price increase in the sample at only 6.21%. France's low vulnerability (9.60) reflects its nuclear dominated system with limited reliance on gas imports. Denmark, Spain, and Bulgaria occupy intermediate positions with vulnerability scores between 11 and 36. Denmark's score is primarily driven by an exceptionally high price increase of 137.90%, the highest in our sample, despite negligible gas imports. Bulgaria shows a low vulnerability score (11.18) due to its minimal price increase of only 5.96%, the second lowest after Poland. This analysis confirms that vulnerability to the energy crisis was not determined by a single factor but rather by the interplay between structural energy dependence, import reliance, and market exposure to price volatility.

```{r}
vulnerability_index <- vulnerability_index |> 
  mutate(vulnerability_level = case_when(
    vulnerability_score >= 50 ~ "High",
    vulnerability_score >= 30 ~ "Medium",
    TRUE ~ "Low"
  ))

ggplot(vulnerability_index, aes(x = reorder(Country, vulnerability_score), y = vulnerability_score, fill = vulnerability_level)) +
  geom_bar(stat = "identity") +
  coord_flip() +
  scale_fill_manual(values = c("Low" = "green3", "Medium" = "orange", "High" = "red")) +
  labs(title = "Vulnerability Index Ranking", 
       x = "Country", 
       y = "Vulnerability Score",
       fill = "Vulnerability Level")
```

## Correlation analysis

```{r}

correlation_data <- vulnerability_data |> 
  select(`gas share`, Import_volume, price_increase)

correlation_matrix <- round(cor(correlation_data, use = "complete.obs"), 2)

kable(correlation_matrix, caption = "Correlation Matrix of Vulnerability Indicators")
```

The correlation matrix reveals weak relationships between our three vulnerability indicators. The correlation between gas share and price increase is modest (0.33), suggesting that gas dependence alone does not fully explain price responses. Import volume shows almost no correlation with gas share (0.06) and a weak negative correlation with price increase (0.18). These weak correlations confirm that vulnerability to the 2022 energy crisis was multidimensional, with each indicator capturing a distinct aspect of exposure rather than moving together systematically.

## Econometric insight: does gas dependence explain price increases?

```{r}
regression_data <- gas_dep |> 
  left_join(price_change, by = "Country")

nuclear_2021 <- rbind(
  mix_france |> filter(year == 2021) |> mutate(Country = "France"),
  mix_bulg |> filter(year == 2021) |> mutate(Country = "Bulgaria"),
  mix_den |> filter(year == 2021) |> mutate(Country = "Denmark"),
  mix_fin |> filter(year == 2021) |> mutate(Country = "Finland"),
  mix_germ |> filter(year == 2021) |> mutate(Country = "Germany"),
  mix_neth |> filter(year == 2021) |> mutate(Country = "Netherlands"),
  mix_pol |> filter(year == 2021) |> mutate(Country = "Poland"),
  mix_spa |> filter(year == 2021) |> mutate(Country = "Spain"),
  mix_swe |> filter(year == 2021) |> mutate(Country = "Sweden")
) |> select(Country, `nuclear share`)

regression_data <- regression_data |> 
  left_join(nuclear_2021, by = "Country")

model <- lm(price_increase ~ `gas share` + `nuclear share`, data = regression_data)
summary(model)
```

We estimate a simple linear regression to test whether pre-crisis energy mix structure explains cross-country variation in price increases:

ΔPrice = β₀ + β₁(Gas Share) + β₂(Nuclear Share) + ε

This specification isolates the impact of gas dependence while controlling for nuclear capacity, which may have provided insulation from the gas price shock.

The regression results indicate that neither gas share nor nuclear share significantly explains cross country variation in electricity price increases during the 2022 crisis. The coefficient on gas share is positive (0.54) but statistically insignificant (p-value = 0.654), suggesting only a weak relationship between gas dependence and price responses. Similarly, the nuclear share coefficient is negative (0.80) but also insignificant (p-value = 0.317).

The model's overall explanatory power is very limited, with an R-squared of only 0.26 and an F-statistic that is not significant (p-value = 0.407). This poor fit confirms our earlier finding from the correlation analysis that structural energy mix characteristics alone cannot explain the heterogeneity in price responses across European countries. Other factors such as market structures, regulatory interventions, interconnection capacity, or storage availability likely played more important roles in determining how prices responded to the gas shock.

```{r}
ggplot(regression_data, aes(x = `gas share`, y = price_increase)) +
  geom_point(size = 3, color = "blue") +
  geom_smooth(method = "lm", se = TRUE, color = "red") +
  geom_text(aes(label = Country), vjust = -1, size = 3) +
  labs(title = "Gas Dependence vs Electricity Price Increase",
       x = "Gas Share in 2021 (%)",
       y = "Price Increase 2021-2022 (%)")
```


The scatter plot reveals why the cross-sectional regression yields insignificant results. Each blue dot represents one country, with the red line showing the fitted relationship and the grey shaded area representing the 95% confidence interval. The very wide confidence interval and nearly flat slope confirm weak predictive power (R² = 0.26). Denmark emerges as a clear outlier, experiencing a 138% price increase despite only 4.33% gas dependence, while Bulgaria and Poland show minimal price increases (5.96% and 6.21%) despite moderate gas shares. Although Netherlands (46% gas share, 88% price increase) aligns with expectations, the overall pattern is dominated by exceptions. This inconsistency suggests that gas dependence alone cannot explain cross-country heterogeneity in price responses, and that other factors—such as market design, regulatory interventions, or interconnection capacity—played decisive roles in determining country-specific outcomes during the crisis.

## Panel Data Analysis of Price Determinants

While our cross-sectional regression provides an initial test of the relationship between energy mix structure and price responses, this approach faces two critical limitations. First, with only nine observations, statistical power is severely constrained. Second, cross-sectional analysis cannot control for unobserved country-specific characteristics—such as market design, regulatory frameworks, interconnection capacity, or storage infrastructure—that may confound the relationship between gas dependence and price outcomes. Denmark's paradoxical combination of low gas dependence (4.33%) yet highest price increase (137.90%) illustrates this problem, likely reflecting its integration into the Nordic electricity market rather than its domestic generation mix. To address these limitations, we now exploit the full panel structure of our dataset (2019-2024), which provides 108 observations and enables us to control for time-invariant country characteristics through fixed effects. This approach also allows us to test a more nuanced hypothesis: whether the 2022 crisis had differential effects across countries based on their pre-existing gas dependence through an interaction between gas share and the post-crisis period.

We exploit the full panel structure of our dataset (2019-2024, nine countries, 108 observations) to test whether gas dependence amplified the crisis impact. We estimate a fixed effects model with country dummies to control for time-invariant characteristics which tests whether gas-dependent countries experienced larger price increases during the crisis (2022 onward). For visualization, we classify countries as "High Gas Dependence" or "Low Gas Dependence" based on median gas share.

```{r, results='hide'}

panel_data <- energy_prices |> 
  pivot_longer(cols = -Country, names_to = "period", values_to = "price") |> 
  mutate(
    year = as.integer(substr(period, 1, 4)),
    semester = ifelse(grepl("S1", period), 1, 2),
    post_crisis = ifelse(year >= 2022, 1, 0),
    log_price = log(price)
  )

panel_mix <- bind_rows(
  mix_france |> mutate(Country = "France"),
  mix_bulg |> mutate(Country = "Bulgaria"),
  mix_den |> mutate(Country = "Denmark"),
  mix_fin |> mutate(Country = "Finland"),
  mix_germ |> mutate(Country = "Germany"),
  mix_neth |> mutate(Country = "Netherlands"),
  mix_pol |> mutate(Country = "Poland"),
  mix_spa |> mutate(Country = "Spain"),
  mix_swe |> mutate(Country = "Sweden")
)

panel_data <- panel_data |> 
  left_join(panel_mix, by = c("Country", "year")) |> 
  filter(!is.na(price) & !is.na(`gas share`))

panel_model <- lm(log_price ~ `gas share` * post_crisis + `nuclear share` + `renewable share` + 
                    factor(Country), 
                  data = panel_data)

summary(panel_model)
```

```{r}
model_coefs <- summary(panel_model)$coefficients

key_results <- data.frame(
  Variable = c("Gas Share", "Nuclear Share", "Renewable Share", 
               "Post-Crisis", "Gas Share × Post-Crisis"),
  Coefficient = c(
    model_coefs["`gas share`", "Estimate"],
    model_coefs["`nuclear share`", "Estimate"],
    model_coefs["`renewable share`", "Estimate"],
    model_coefs["post_crisis", "Estimate"],
    model_coefs["`gas share`:post_crisis", "Estimate"]
  ),
  `Std. Error` = c(
    model_coefs["`gas share`", "Std. Error"],
    model_coefs["`nuclear share`", "Std. Error"],
    model_coefs["`renewable share`", "Std. Error"],
    model_coefs["post_crisis", "Std. Error"],
    model_coefs["`gas share`:post_crisis", "Std. Error"]
  ),
  `p-value` = c(
    model_coefs["`gas share`", "Pr(>|t|)"],
    model_coefs["`nuclear share`", "Pr(>|t|)"],
    model_coefs["`renewable share`", "Pr(>|t|)"],
    model_coefs["post_crisis", "Pr(>|t|)"],
    model_coefs["`gas share`:post_crisis", "Pr(>|t|)"]
  ),
  check.names = FALSE
) |> 
  mutate(
    Coefficient = round(Coefficient, 4),
    `Std. Error` = round(`Std. Error`, 4),
    `p-value` = round(`p-value`, 4),
    Significance = case_when(
      `p-value` < 0.01 ~ "***",
      `p-value` < 0.05 ~ "**",
      `p-value` < 0.1 ~ "*",
      TRUE ~ ""
    )
  )

kable(key_results, 
      caption = "Panel Regression Results: Crisis Amplification by Gas Dependence",
      align = c("l", "r", "r", "r", "c"))

model_stats <- data.frame(
  Statistic = c("Observations", "R-squared", "Adjusted R-squared"),
  Value = c(
    nrow(panel_model$model),
    round(summary(panel_model)$r.squared, 3),
    round(summary(panel_model)$adj.r.squared, 3)
  )
)

kable(model_stats, caption = "Model Fit Statistics")
```

The panel regression confirms that gas dependence systematically amplified the 2022 energy crisis impact. The interaction term (Gas Share × Post-Crisis) is positive and statistically significant (coefficient = 0.0085, p = 0.012), indicating that each additional percentage point of gas share in the electricity mix increased crisis-period prices by approximately 0.85% in log terms. The baseline crisis effect shows all countries experienced substantial price increases averaging 29.2% during 2022 (coefficient = 0.292, p < 0.001), but this effect was magnified in gas-dependent countries. Individual energy mix variables (gas share, nuclear share, renewable share) are all insignificant, confirming that structural characteristics matter primarily through their interaction with external shocks rather than determining baseline price levels. The model achieves excellent explanatory power with an R² of 0.818, explaining 82% of price variation across countries and time—a substantial improvement over the cross-sectional model's 26%. These results provide robust evidence that while all European countries faced the same gas price shock, gas-dependent nations bore a disproportionately larger burden, with our predictions showing countries at 40% gas dependence experiencing nearly double the price increase (88.5%) compared to those at 10% dependence (45.9%).


```{r}
panel_data <- panel_data |> 
  mutate(gas_category = ifelse(`gas share` >= median(`gas share`, na.rm = TRUE), 
                                "High Gas Dependence", 
                                "Low Gas Dependence"))

avg_by_gas <- panel_data |> 
  group_by(year, gas_category) |> 
  summarize(avg_price = mean(price, na.rm = TRUE), .groups = 'drop')

ggplot(avg_by_gas, aes(x = year, y = avg_price, color = gas_category, group = gas_category)) +
  geom_line(size = 1.2) +
  geom_point(size = 3) +
  geom_vline(xintercept = 2022, linetype = "dashed", color = "red") +
  annotate("text", x = 2021.5, y = max(avg_by_gas$avg_price) * 0.95,
           label = "Crisis onset", color = "red", size = 4, hjust = 1) +
  labs(title = "Electricity Prices by Gas Dependence Category (2019-2024)",
       subtitle = "Countries grouped by median gas share",
       x = "Year",
       y = "Average Electricity Price (EUR/MWh)",
       color = "Gas Dependence") +
  scale_color_manual(values = c("High Gas Dependence" = "red3", 
                                "Low Gas Dependence" = "blue3")) +
  theme_minimal() +
  theme(legend.position = "bottom",
        plot.title = element_text(size = 14, face = "bold"))


post_crisis_coef <- 0.2923
interaction_coef <- 0.00854

low_gas_effect <- (exp(post_crisis_coef + 10 * interaction_coef) - 1) * 100
high_gas_effect <- (exp(post_crisis_coef + 40 * interaction_coef) - 1) * 100

predicted_effects <- data.frame(
  `Gas Dependence Level` = c("Low (10% gas share)", "High (40% gas share)"),
  `Predicted Price Increase from Crisis` = c(
    paste0(round(low_gas_effect, 1), "%"),
    paste0(round(high_gas_effect, 1), "%")
  ),
  check.names = FALSE
)

kable(predicted_effects, 
      caption = "Predicted Crisis Effects by Gas Dependence Level (based on Panel Model)")
```

The figure illustrates the differential crisis impact by gas dependence. Before 2022, both groups show parallel trajectories around 120 EUR/MWh (high-gas) and 105 EUR/MWh (low-gas). Following the crisis onset, the gap widens dramatically: high-gas countries surge to over 230 EUR/MWh while low-gas countries rise only to 175 EUR/MWh. This visual divergence directly confirms the significant interaction effect, demonstrating that pre-existing gas dependence amplified crisis vulnerability.
The table quantifies this heterogeneity using our estimated coefficients. A country with 10% gas dependence experienced a predicted 45.9% price increase during the crisis, while a country with 40% gas dependence faced an 88.5% increase—nearly double the impact. This substantial differential (42.6 percentage points) demonstrates that structural energy characteristics acted as latent vulnerabilities, only revealed under the stress of the external shock.


## European map of price increases

```{r}

europe <- ne_countries(scale = "medium", continent = "Europe", returnclass = "sf")

map_data <- price_change |> 
  mutate(name = case_when(
    Country == "Netherlands" ~ "Netherlands",
    Country == "Germany" ~ "Germany",
    Country == "Spain" ~ "Spain",
    Country == "France" ~ "France",
    Country == "Denmark" ~ "Denmark",
    Country == "Finland" ~ "Finland",
    Country == "Poland" ~ "Poland",
    Country == "Sweden" ~ "Sweden",
    TRUE ~ Country
  ))

europe_prices <- europe |> 
  left_join(map_data, by = "name")

ggplot(europe_prices) +
  geom_sf(aes(fill = price_increase), color = "white") +
  scale_fill_gradient2(low = "green", mid = "orange", high = "red", 
                       midpoint = 50, na.value = "grey90",
                       name = "Price Increase (%)") +
  coord_sf(xlim = c(-10, 30), ylim = c(35, 70)) +
  labs(title = "Electricity Price Increase Across Europe (2021-2022)",
       subtitle = "Percentage change in average electricity prices") +
  theme_minimal()
```

The map visualizes the geographic distribution of electricity price increases across Europe between 2021 and 2022, revealing significant spatial heterogeneity. Denmark stands out with the highest price increase at 138%, represented in red, despite its low gas dependence. Southern European countries like Spain and the Netherlands experienced substantial increases of 71% and 88% respectively, shown in orange. In contrast, Eastern and Northern European countries display more moderate responses. Poland and Bulgaria show the lowest increases at only 6%, represented in green, while France, Finland, and Sweden experienced relatively contained surges between 24% and 40%, shown in yellow. Notably, the map does not reveal a clear geographic pattern suggesting regional spillover effects. High impact countries are geographically dispersed, while neighboring countries experienced vastly different outcomes. Bulgaria and Poland, both in Eastern Europe, had minimal price increases while nearby countries faced much larger shocks. This spatial heterogeneity reinforces our finding that country specific factors played more important roles than geographic proximity in determining vulnerability to the 2022 energy crisis.

# FINDINGS AND CONCLUSION

## Findings

This analysis examined the heterogeneous responses of nine European countries to the 2022 energy crisis, asking: *What explains the cross-country variation in vulnerability and response to the 2022 energy shock?*


**The Shock** Natural gas prices surged 584% from EUR 23.5 to EUR 160.9 per MWh, transmitting rapidly to electricity markets with an 85% average price increase to EUR 224.1 per MWh. Both remained elevated through 2024, indicating persistent structural changes.

**Limited Structural Adjustment** Energy mix structures remained remarkably rigid despite the shock severity. Only the Netherlands showed significant transformation, shifting from 55% gas pre-crisis to 38% post-crisis. On average, countries reduced gas shares by minimal amounts, confirming that adjustment occurred primarily through prices rather than technology due to infrastructural constraints.

**Heterogeneous Persistence** France, Germany, and Bulgaria exhibited highly persistent shocks (half-lives exceeding 8 semesters), while Poland and Sweden showed rapid reversion (approximately 1 semester). Average persistence was 5 semesters, but this variation indicates vastly different welfare burdens across countries.

**Vulnerability Patterns** The composite index identified Netherlands (56.01) and Germany (50.88) as most vulnerable, versus Poland (6.67) and France (9.60) as least vulnerable. However, weak correlations between individual indicators (gas share and price increase: 0.33) confirmed multidimensional vulnerability.

**Gas Dependence as an amplifier**  Cross-sectional analysis found no significant relationship (R² = 0.26, p = 0.407), exemplified by Denmark's paradox: 4.33% gas dependence yet 138% price increase. Panel regression revealed the true pattern: the interaction term was significant (coefficient = 0.0085, p = 0.012), showing each percentage point of gas dependence amplified crisis prices by 0.85% in log terms (R² = 0.818). Countries with 40% gas dependence experienced 88.5% price increases versus 45.9% for those with 10% dependence nearly double the impact.

## Answering the research question 

Gas dependence in electricity generation was the systematic driver of differential vulnerability, but only during the crisis itself. The panel regression demonstrates that pre-existing gas share did not predict baseline price levels (explaining the insignificant cross-sectional results) but critically determined crisis amplification through the significant interaction effect. Each additional percentage point of gas dependence increased crisis-period prices by 0.85%, resulting in countries with 40% gas facing nearly double the price impact of those with 10% gas.
This pattern reveals that structural energy characteristics operated as latent vulnerabilities, decisive under stress. Gas-dependent systems lacked buffer capacity when the fuel price shock hit, while nuclear- and renewable-heavy systems possessed inherent resilience. The 2022 crisis thus exposed fundamental asymmetries in European energy systems: despite facing the same external shock through integrated markets, countries experienced vastly different economic impacts based on their pre-existing generation structures. With elevated prices persisting through 2024 and minimal structural adjustment observed, these vulnerabilities remain largely unaddressed, carrying significant implications for European energy security.

