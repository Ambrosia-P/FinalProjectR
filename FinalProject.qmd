---
title: "The 2022 european energy crisis"
format: html
editor: visual
autors: "Lou-Ann and Ambrosia"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)

```

# Introduction

```{r}
library(ggplot2)
library(readr)
library(vroom)
library(dplyr)
library(tidyr)
library(tidyverse)
library(ggplot2)
library(knitr)
```
### Data Loading

```{r}
energy_prices <- read.csv("cleaned_data/Energypricescleaned.csv", sep = ";")
energy_prices <- energy_prices[-c(2,11),] 
colnames(energy_prices)[-1] <- sub("^X", "", colnames(energy_prices)[-1])

gas_prices <- read.csv("cleaned_data/Gaspricescleaned.csv", sep= ";")

importation <- read.csv("cleaned_data/Total_import.csv")
importation_list <- split(importation, importation$Country)

sources <- read.csv("cleaned_data/all_sources.csv")
sources_list <- split(sources, sources$Country)
```


# Data description

# Analysis

## part 1

## National Energy mix structures

In this section, we will focus on the national energy mix structures before and after the gas price shock. Indeed, we will study the structural difference across countries and how these structures changes over time as a response to the shock. 
Two type of comparison will provide insight into the dynamics triggered by the 2022 crisis : 
- A cross country comparison allows us to show that the countries enter the 2022 crisis with different profiles and exposure levels
- A comparison pre/post shock within a same country will highlight the potential adjustment in its energy system triggerred by the crisis.

This part is fundamental to the structure of our analysis since it will justify the persistance of the shocks and the heterogeneity of the responses provided. 

### Energy mix computation

```{r}
france_sources <- sources_list$France

mix_france <- france_sources |> mutate(combustible = Combustible.fuels- Natural.gas) |> mutate(`combustible share` = round((combustible/Total)*100, 2), `nuclear share` = round((Nuclear.fuels.and.other.fuels.n.e.c./Total)*100, 2), `gas share` = round((Natural.gas/Total)*100, 2), `renewable share` = round((Renewables.and.biofuels/Total)*100, 2))
mix_france <- mix_france[,-c(3:11)]

bulg_sources <- sources_list$Bulgaria

mix_bulg <- bulg_sources |> mutate(combustible = Combustible.fuels- Natural.gas) |> mutate(`combustible share` = round((combustible/Total)*100, 2), `nuclear share` = round((Nuclear.fuels.and.other.fuels.n.e.c./Total)*100, 2), `gas share` = round((Natural.gas/Total)*100, 2), `renewable share` = round((Renewables.and.biofuels/Total)*100, 2))
mix_bulg <- mix_bulg[,-c(3:11)]

germ_sources <- sources_list$Germany

mix_germ <- germ_sources |> mutate(combustible = Combustible.fuels- Natural.gas) |> mutate(`combustible share` = round((combustible/Total)*100, 2), `nuclear share` = round((Nuclear.fuels.and.other.fuels.n.e.c./Total)*100, 2), `gas share` = round((Natural.gas/Total)*100, 2), `renewable share` = round((Renewables.and.biofuels/Total)*100, 2))
mix_germ <- mix_germ[,-c(3:11)]

den_sources <- sources_list$Denmark

mix_den <- den_sources |> mutate(combustible = Combustible.fuels- Natural.gas) |> mutate(`combustible share` = round((combustible/Total)*100, 2), `nuclear share` = round((Nuclear.fuels.and.other.fuels.n.e.c./Total)*100, 2), `gas share` = round((Natural.gas/Total)*100, 2), `renewable share` = round((Renewables.and.biofuels/Total)*100, 2))
mix_den <- mix_den[,-c(3:11)]

spa_sources <- sources_list$Spain

mix_spa <- spa_sources |> mutate(combustible = Combustible.fuels- Natural.gas) |> mutate(`combustible share` = round((combustible/Total)*100, 2), `nuclear share` = round((Nuclear.fuels.and.other.fuels.n.e.c./Total)*100, 2), `gas share` = round((Natural.gas/Total)*100, 2), `renewable share` = round((Renewables.and.biofuels/Total)*100, 2))
mix_spa <- mix_spa[,-c(3:11)]

fin_sources <- sources_list$Finland

mix_fin <- fin_sources |> mutate(combustible = Combustible.fuels- Natural.gas) |> mutate(`combustible share` = round((combustible/Total)*100, 2), `nuclear share` = round((Nuclear.fuels.and.other.fuels.n.e.c./Total)*100, 2), `gas share` = round((Natural.gas/Total)*100, 2), `renewable share` = round((Renewables.and.biofuels/Total)*100, 2))
mix_fin <- mix_fin[,-c(3:11)]

neth_sources <- sources_list$Netherlands

mix_neth <- neth_sources |> mutate(combustible = Combustible.fuels- Natural.gas) |> mutate(`combustible share` = round((combustible/Total)*100, 2), `nuclear share` = round((Nuclear.fuels.and.other.fuels.n.e.c./Total)*100, 2), `gas share` = round((Natural.gas/Total)*100, 2), `renewable share` = round((Renewables.and.biofuels/Total)*100, 2))
mix_neth <- mix_neth[,-c(3:11)]

pol_sources <- sources_list$Poland

mix_pol <- pol_sources |> mutate(combustible = Combustible.fuels- Natural.gas) |> mutate(`combustible share` = round((combustible/Total)*100, 2), `nuclear share` = round((Nuclear.fuels.and.other.fuels.n.e.c./Total)*100, 2), `gas share` = round((Natural.gas/Total)*100, 2), `renewable share` = round((Renewables.and.biofuels/Total)*100, 2))
mix_pol <- mix_pol[,-c(3:11)]

swe_sources <- sources_list$Sweden

mix_swe <- swe_sources |> mutate(combustible = Combustible.fuels- Natural.gas) |> mutate(`combustible share` = round((combustible/Total)*100, 2), `nuclear share` = round((Nuclear.fuels.and.other.fuels.n.e.c./Total)*100, 2), `gas share` = round((Natural.gas/Total)*100, 2), `renewable share` = round((Renewables.and.biofuels/Total)*100, 2))
mix_swe <- mix_swe[,-c(3:11)]
```

```{r}
mix_france <- mix_france |> mutate(year = as.integer(substr(Year, 1, 4))) |> group_by(year) |> summarize(`combustible share`= round(mean(`combustible share`),2), `nuclear share`= round(mean(`nuclear share`),2), `gas share`=round(mean(`gas share`),2), `renewable share`=round(mean(`renewable share`),2))

kable(mix_france, caption = "France's Energy Mix per year (percent)")

mix_bulg <- mix_bulg |> mutate(year = as.integer(substr(Year, 1, 4))) |> group_by(year) |> summarize(`combustible share`= round(mean(`combustible share`),2), `nuclear share`= round(mean(`nuclear share`),2), `gas share`=round(mean(`gas share`),2), `renewable share`=round(mean(`renewable share`),2))

kable(mix_bulg, caption = "Bulgaria's Energy Mix per year (percent)")

mix_den <- mix_den |> mutate(year = as.integer(substr(Year, 1, 4))) |> group_by(year) |> summarize(`combustible share`= round(mean(`combustible share`),2), `nuclear share`= round(mean(`nuclear share`),2), `gas share`=round(mean(`gas share`),2), `renewable share`=round(mean(`renewable share`),2))

kable(mix_den, caption = "Denmark's Energy Mix per year (percent)")

mix_fin <- mix_fin |> mutate(year = as.integer(substr(Year, 1, 4))) |> group_by(year) |> summarize(`combustible share`= round(mean(`combustible share`),2), `nuclear share`= round(mean(`nuclear share`),2), `gas share`=round(mean(`gas share`),2), `renewable share`=round(mean(`renewable share`),2))

kable(mix_fin, caption = "Finland's Energy Mix per year (percent)")

mix_germ <- mix_germ |> mutate(year = as.integer(substr(Year, 1, 4))) |> group_by(year) |> summarize(`combustible share`= round(mean(`combustible share`),2), `nuclear share`= round(mean(`nuclear share`),2), `gas share`=round(mean(`gas share`),2), `renewable share`=round(mean(`renewable share`),2))

kable(mix_germ, caption = "Germany's Energy Mix per year (percent)")

mix_neth <- mix_neth|> mutate(year = as.integer(substr(Year, 1, 4))) |> group_by(year) |> summarize(`combustible share`= round(mean(`combustible share`),2), `nuclear share`= round(mean(`nuclear share`),2), `gas share`=round(mean(`gas share`),2), `renewable share`=round(mean(`renewable share`),2))

kable(mix_neth, caption = "Netherlands' Energy Mix per year (percent)")

mix_pol <- mix_pol |> mutate(year = as.integer(substr(Year, 1, 4))) |> group_by(year) |> summarize(`combustible share`= round(mean(`combustible share`),2), `nuclear share`= round(mean(`nuclear share`),2), `gas share`=round(mean(`gas share`),2), `renewable share`=round(mean(`renewable share`),2))

kable(mix_pol, caption = "Poland's Energy Mix per year (percent)")

mix_spa <- mix_spa |> mutate(year = as.integer(substr(Year, 1, 4))) |> group_by(year) |> summarize(`combustible share`= round(mean(`combustible share`),2), `nuclear share`= round(mean(`nuclear share`),2), `gas share`=round(mean(`gas share`),2), `renewable share`=round(mean(`renewable share`),2))

kable(mix_spa, caption = "Spain's Energy Mix per year (percent)")

mix_swe <- mix_swe |> mutate(year = as.integer(substr(Year, 1, 4))) |> group_by(year) |> summarize(`combustible share`= round(mean(`combustible share`),2), `nuclear share`= round(mean(`nuclear share`),2), `gas share`=round(mean(`gas share`),2), `renewable share`=round(mean(`renewable share`),2))

kable(mix_swe, caption = "sweden's Energy Mix per year (percent)")
```

